# テーブルの作成: CREATE TABLE文

ここまで、データの読み書き更新削除（CRUD）の基本操作を学びました。これらは既に存在するテーブルに対して行う操作ですが、**テーブルそのものを新しく作る**操作も当然必要になります。それが**CREATE TABLE文**です。

新しいテーブルを作成するときは、Excelで新しいシートを作るようなものですが、**あらかじめどんな項目（列）を持つか、どんな種類のデータを入れるか（データ型）、どの列を主キーにするか**などを定義して作成します。

## CREATE TABLE文の構文

基本的な構文は以下の通りです。

```sql
CREATE TABLE テーブル名 (
  列名1 データ型 オプション,
  列名2 データ型 オプション,
  ... 
);
```

- `CREATE TABLE テーブル名`：これから作成するテーブルの名前を指定します。既存の他のテーブルと被らないような名前を付けます。名前は半角英数字とアンダースコア(_)で定義し、慣習的に小文字で書くことが多いです。
- `列名 データ型 オプション`：テーブルに作成する各列（カラム）を定義します。各列について、名前、データ型、制約（オプション）を指定し、カンマ`,`で区切ります。

**データ型**とは、その列にどんな種類のデータを入れるかを表します。代表的なデータ型の例:
- 数値：`INTEGER`（整数）, `REAL`や`NUMERIC`（小数を含む実数）など  
- 文字列：`TEXT`（可変長テキスト）, `VARCHAR(n)`（最大n文字の可変長テキスト）など  
- 日付・時間：`DATE`（日付）, `TIMESTAMP`（日時）など  
- 論理値：`BOOLEAN`（真または偽）  

**オプション（制約）**には例えば以下のようなものがあります:
- `PRIMARY KEY`：その列を主キー（各行を一意に識別するID）に指定します。他の行と重複する値を持つことはできません。
- `NOT NULL`：その列にNULL（値なし）を入れない制約。必ず何らかの値が入っている必要があります。
- `UNIQUE`：その列の値が重複しないようにする制約。
- `DEFAULT <値>`：値が指定されなかった場合のデフォルト値を設定。

初心者向けには、まず**主キー (PRIMARY KEY)**の指定と、簡単なデータ型から押さえると良いでしょう。

**例:** ユーザー情報を格納する`users`テーブルを新規に作成するとします。各ユーザーを識別するIDと、名前、年齢を保存したい場合、IDは自動採番される整数の主キー、名前はテキスト、年齢は整数で定義できます。`CREATE TABLE`文は次のようになります。

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  name TEXT,
  age INTEGER
);
```

- `id SERIAL PRIMARY KEY`：`id`列を**SERIAL型**（PostgreSQL独自の簡易的な自動連番整数型）で作成し、主キーに指定しています。これにより、新しい行が追加されるたびに`id`が1から順に自動付与されます。主キーなので重複する値は入りません。
- `name TEXT`：`name`列はTEXT型（長さ可変の文字列）です。ここでは制約を特に設けていません（NULLも許容、重複も許容）。
- `age INTEGER`：`age`列はINTEGER型（32ビット整数）です。こちらも特に制約は設けていません。

上記のようにSQLを実行すると、新しい`users`テーブルが作成されます。**テーブル作成はデータベース内の構造を変更する操作（DDL: Data Definition Language）**なので、成功すれば「CREATE TABLE」といったメッセージが返り、以降そのテーブルを利用できるようになります。

作成直後のテーブルはまだ空（行が0件）です。`INSERT`文を使ってデータを追加し、その後`SELECT`で確認するといった手順になります。

> 🔍 **ポイント:**  
> - **テーブル名や列名**には、半角英字で始まる名前をつけます。スペースやハイフンは使えません（使う場合はダブルクオートで囲う必要がありますが推奨されません）。例: `users`、`user_name`、`created_at`など。  
> - PostgreSQLではテーブル名や列名は小文字に変換されて格納されるため、特別な理由がなければ**すべて小文字**で名前を付けておくと良いです。  
> - `SERIAL`型は便利な自動採番型ですが、内部的には`INTEGER`型＋専用のシーケンスオブジェクトで実装されています。PostgreSQL 14以降では`SERIAL`よりも`GENERATED AS IDENTITY`の使用が推奨されていますが、初心者であれば`SERIAL`の方が簡単なので本教材では使用しています。  
> - テーブルを削除するには`DROP TABLE テーブル名;`というSQLを使います（今回は使用しませんが、覚えておくと良いでしょう）。

## pgAdminを使ったテーブル作成 (GUI)

補足として、pgAdmin上でGUI操作によってテーブルを作成することも可能です。pgAdminのサーバー内のデータベースを右クリックし、「Create」->「Table...」を選ぶとテーブル作成ダイアログが開きます。ここでテーブル名やカラム情報を入力して作成することもできます。GUIで操作するとSQL文が見えないため学習には向きませんが、裏では同様の`CREATE TABLE`文が実行されていることを念頭に置いてください。