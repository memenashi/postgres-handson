# データの更新と削除: UPDATE文とDELETE文

既存のデータを変更するには**UPDATE文**を、不要なデータを削除するには**DELETE文**を使用します。Excelで言えば、セルの値を上書きする操作や行を削除する操作に対応します。これらも基本的なCRUD操作の一部です。

## UPDATE文: データの更新

**UPDATE文**はテーブル内の既存の行の特定の列の値を更新（書き換え）します。

構文は以下の通りです。

```sql
UPDATE テーブル名 
SET 列1 = 新しい値1, 列2 = 新しい値2, ... 
WHERE 条件;
```

- `UPDATE テーブル名`：どのテーブルのデータを更新するか指定します。  
- `SET 列 = 値`：更新したい対象の列と、新しい値を指定します（複数列を同時に更新可能です）。  
- `WHERE 条件`：どの行を更新するかを指定します。条件に合致した行すべてが更新対象になります。**必ず指定するのが基本**です。条件を付けないとテーブル内の全行が更新されてしまうため注意が必要です。

**例:** 先ほどの`users`テーブルで、`Alice`さんの年齢を25歳から26歳に更新するSQLは以下のようになります。

```sql
UPDATE users 
SET age = 26 
WHERE name = 'Alice';
```

これにより、`name`が`Alice`である行の`age`列の値が26に更新されます。実行後に`SELECT * FROM users WHERE name = 'Alice';`で確認すると、Aliceさんの年齢が26になっているはずです。

別の例として、もし各ユーザーにIDが振られている場合（例えば`id`列がある場合）、特定のIDの行を更新することもできます。

```sql
UPDATE users 
SET age = 33 
WHERE id = 2;
```

上記は`id`が2のユーザーの年齢を33に変更します。一般的には、名前などよりIDで対象を指定する方が確実ですが、本教材の例ではまだ`id`列を扱っていないため、まずは分かりやすい値で条件を指定してみましょう。

## DELETE文: データの削除

**DELETE文**はテーブルから行を削除する（消去する）ためのSQL文です。

構文は以下の通りです。

```sql
DELETE FROM テーブル名 
WHERE 条件;
```

- `DELETE FROM テーブル名`：どのテーブルから行を削除するか指定します。  
- `WHERE 条件`：削除する行の条件を指定します。条件に合致した行はすべて削除されます。**UPDATEと同様、必ず条件を指定するのが基本**です。条件を付けないとテーブルの全データが削除されてしまいます。

**例:** `users`テーブルから、名前が`George`のユーザーの行を削除する場合:

```sql
DELETE FROM users 
WHERE name = 'George';
```

これを実行すると、`name`が`George`である行がテーブルから取り除かれます。削除後に`SELECT * FROM users;`で確認すると、Georgeさんのデータが消えていることがわかります。

## 実際に試してみる

実際にUPDATEとDELETEを試してみましょう。pgAdminのクエリツールで以下のSQLを順番に実行してください。

```sql
-- 例: Aliceさんの年齢を1歳増やす（25→26に変更）
UPDATE users 
SET age = 26 
WHERE name = 'Alice';
```

実行後、`SELECT * FROM users WHERE name = 'Alice';`でAliceさんのレコードを確認し、`age`が26に変わっていれば成功です。

次に、データの削除を試します。

```sql
-- 例: Georgeさんのデータを削除する
DELETE FROM users 
WHERE name = 'George';
```

こちらも、実行後に`SELECT * FROM users;`でテーブル全体を表示し、`George`さんの行がなくなっていることを確認してください。

> 🔍 **ポイント:**  
> - UPDATEやDELETEでは**WHERE句を適切に使うことが非常に重要**です。条件を誤ると意図しない行を更新・削除してしまう可能性があります。例えば、`WHERE name = 'Alice'`を付け忘れて`UPDATE users SET age = 26;`と実行すると、全ユーザーの年齢が26になってしまうので注意してください。  
> - データを削除した場合、その操作を元に戻す（UNDO）ことは簡単にはできません（特にDELETEは破壊的操作です）。誤って削除してしまった場合に備えて、重要なデータベースではバックアップを取る運用が必要です。学習用のデータでも、DELETEを実行する前に本当に削除してよいか一呼吸おいて確認する癖をつけましょう。